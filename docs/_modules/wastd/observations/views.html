

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>wastd.observations.views &mdash; WAStD 0.50.7 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> WAStD
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../data_collection/data_collection_overview.html">Data collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_collection/data_collection_admin.html">Data collection administrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_collection/data_collection_training.html">Data collection training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_curators.html">Data curators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_curators.html#data-upload-from-odk">Data upload from ODK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_qa.html">Data QA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_qa.html#data-release">Data release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_consumers.html">Data consumers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../business_analysts.html">Business Analysts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../business_analysts.html#how-it-s-made-the-process">How itâ€™s made - the process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../business_analysts.html#reproducible-research">Reproducible Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainers.html">Application maintainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers.html#project-delivery-ticking-the-boxes">Project delivery: ticking the boxes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">WAStD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>wastd.observations.views</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for wastd.observations.views</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Views for WAStD.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">messages</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">transaction</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">django.utils.safestring</span> <span class="kn">import</span> <span class="n">mark_safe</span>
<span class="kn">from</span> <span class="nn">django.views.decorators.csrf</span> <span class="kn">import</span> <span class="n">csrf_exempt</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">ListView</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">,</span> <span class="n">UpdateView</span>
<span class="kn">from</span> <span class="nn">export_download.views</span> <span class="kn">import</span> <span class="n">ResourceDownloadMixin</span>
<span class="c1"># Tables</span>
<span class="kn">from</span> <span class="nn">django_tables2</span> <span class="kn">import</span> <span class="n">RequestConfig</span><span class="p">,</span> <span class="n">SingleTableView</span><span class="p">,</span> <span class="n">tables</span>
<span class="kn">from</span> <span class="nn">rest_framework.renderers</span> <span class="kn">import</span> <span class="n">CoreJSONRenderer</span>
<span class="kn">from</span> <span class="nn">rest_framework.schemas</span> <span class="kn">import</span> <span class="n">get_schema_view</span>
<span class="kn">from</span> <span class="nn">rest_framework_swagger.renderers</span> <span class="kn">import</span> <span class="n">OpenAPIRenderer</span><span class="p">,</span> <span class="n">SwaggerUIRenderer</span>
<span class="kn">from</span> <span class="nn">sentry_sdk</span> <span class="kn">import</span> <span class="n">capture_message</span>

<span class="kn">from</span> <span class="nn">shared.views</span> <span class="kn">import</span> <span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailViewBreadcrumbMixin</span>

<span class="kn">from</span> <span class="nn">wastd.observations.filters</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SurveyFilter</span><span class="p">,</span>
    <span class="n">EncounterFilter</span><span class="p">,</span>
    <span class="n">AnimalEncounterFilter</span><span class="p">,</span>
    <span class="n">TurtleNestEncounterFilter</span><span class="p">,</span>
    <span class="n">LineTransectEncounterFilter</span><span class="p">,</span>
    <span class="n">LoggerEncounterFilter</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">wastd.observations.forms</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">EncounterListFormHelper</span><span class="p">,</span>
    <span class="n">AnimalEncounterForm</span><span class="p">,</span>
    <span class="n">AnimalEncounterListFormHelper</span><span class="p">,</span>
    <span class="n">FlipperTagObservationFormSet</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">wastd.observations.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Survey</span><span class="p">,</span>
    <span class="n">Encounter</span><span class="p">,</span>
    <span class="n">AnimalEncounter</span><span class="p">,</span>
    <span class="n">TurtleNestEncounter</span><span class="p">,</span>
    <span class="n">LoggerEncounter</span><span class="p">,</span>
    <span class="n">LineTransectEncounter</span><span class="p">,</span>
    <span class="n">TagObservation</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">wastd.observations.resources</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SurveyResource</span><span class="p">,</span>
    <span class="n">EncounterResource</span><span class="p">,</span>
    <span class="n">AnimalEncounterResource</span><span class="p">,</span>
    <span class="n">TurtleNestEncounterResource</span><span class="p">,</span>
    <span class="n">LineTransectEncounterResource</span><span class="p">,</span>
    <span class="n">LoggerEncounterResource</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">wastd.observations.tasks</span> <span class="kn">import</span> <span class="n">import_odka</span><span class="p">,</span> <span class="n">update_names</span><span class="p">,</span> <span class="n">reconstruct_surveys</span>

<div class="viewcode-block" id="import_odka_view"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.import_odka_view">[docs]</a><span class="nd">@csrf_exempt</span>
<span class="k">def</span> <span class="nf">import_odka_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import all available ODK-Aggregate forms.&quot;&quot;&quot;</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="s2">&quot;[wastd.observations.views.import_odka_view] Starting ODKA import.&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">import_odka</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="update_names_view"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.update_names_view">[docs]</a><span class="nd">@csrf_exempt</span>
<span class="k">def</span> <span class="nf">update_names_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import all available ODK-Aggregate forms.&quot;&quot;&quot;</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="s2">&quot;[wastd.observations.views.update_names] Rebuilding names.&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">update_names</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="reconstruct_surveys_view"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.reconstruct_surveys_view">[docs]</a><span class="nd">@csrf_exempt</span>
<span class="k">def</span> <span class="nf">reconstruct_surveys_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import all available ODK-Aggregate forms.&quot;&quot;&quot;</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="s2">&quot;[wastd.observations.views.reconstruct_surveys_view] Rreconstructing surveys.&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">reconstruct_surveys</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">capture_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="HomeView"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.HomeView">[docs]</a><span class="k">class</span> <span class="nc">HomeView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;HomeView.&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s2">&quot;pages/map.html&quot;</span>

<div class="viewcode-block" id="HomeView.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.HomeView.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Context data.&quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">HomeView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;now&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="HomeView.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.HomeView.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queryset.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AnimalEncounter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">encounter_type</span><span class="o">=</span><span class="s2">&quot;stranding&quot;</span><span class="p">)</span></div></div>


<span class="c1">#-----------------------------------------------------------------------------#</span>
<span class="c1"># Survey</span>
<div class="viewcode-block" id="SurveyList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.SurveyList">[docs]</a><span class="k">class</span> <span class="nc">SurveyList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Survey</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">SurveyFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">SurveyResource</span>

<div class="viewcode-block" id="SurveyList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.SurveyList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurveyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurveyFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="SurveyList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.SurveyList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurveyList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">,</span> <span class="s2">&quot;encounter_set&quot;</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-start_time&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SurveyFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="SurveyDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.SurveyDetail">[docs]</a><span class="k">class</span> <span class="nc">SurveyDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Survey</span>

<div class="viewcode-block" id="SurveyDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.SurveyDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurveyDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># obj = self.get_object()</span>
        <span class="c1"># survey_ids = [survey.pk for survey in obj.duplicate_surveys.all()] + [obj.pk]</span>
        <span class="c1"># data[&#39;encounters&#39;] = Encounter.objects.filter(survey_id__in=survey_ids)</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<div class="viewcode-block" id="close_survey_duplicates"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.close_survey_duplicates">[docs]</a><span class="k">def</span> <span class="nf">close_survey_duplicates</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Close duplicates for a given Survey PK with the request user as actor.</span>


<span class="sd">    All duplicate Surveys will be curated and marked as &quot;not production&quot;.</span>
<span class="sd">    The given Survey will be curated and marked as &quot;production&quot;,</span>
<span class="sd">    adopt all Encounters from all duplicate surveys, and adjust its duration.</span>

<span class="sd">    See Survey.close_duplicates() for implementation details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Survey</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">close_duplicates</span><span class="p">(</span><span class="n">actor</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_absolute_url</span><span class="p">())</span></div>


<span class="c1"># Encounters -----------------------------------------------------------------#</span>
<span class="c1"># https://kuttler.eu/en/post/using-django-tables2-filters-crispy-forms-together/</span>
<span class="c1"># http://stackoverflow.com/questions/25256239/</span>
<div class="viewcode-block" id="EncounterTable"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterTable">[docs]</a><span class="k">class</span> <span class="nc">EncounterTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A data table for Encounters.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="EncounterTable.Meta"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterTable.Meta">[docs]</a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Model opts.&quot;&quot;&quot;</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">Encounter</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;as_html&quot;</span><span class="p">,</span> <span class="s2">&quot;as_latex&quot;</span><span class="p">,</span> <span class="s2">&quot;polymorphic_ctype&quot;</span><span class="p">,</span> <span class="s2">&quot;encounter_ptr&quot;</span><span class="p">]</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;table table-hover table-inverse table-sm&#39;</span><span class="p">}</span></div></div>


<div class="viewcode-block" id="AnimalEncounterTable"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterTable">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A data table for AnimalEncounters.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="AnimalEncounterTable.Meta"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterTable.Meta">[docs]</a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Model opts.&quot;&quot;&quot;</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;as_html&quot;</span><span class="p">,</span> <span class="s2">&quot;as_latex&quot;</span><span class="p">,</span> <span class="s2">&quot;polymorphic_ctype&quot;</span><span class="p">,</span> <span class="s2">&quot;encounter_ptr&quot;</span><span class="p">]</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;table table-hover table-inverse table-sm&#39;</span><span class="p">}</span></div></div>


<div class="viewcode-block" id="PagedFilteredTableView"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.PagedFilteredTableView">[docs]</a><span class="k">class</span> <span class="nc">PagedFilteredTableView</span><span class="p">(</span><span class="n">SingleTableView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generic class for paged, filtered SingleTableView.</span>

<span class="sd">    Inherit from this class and set the class level attributes (``model`` etc.).</span>

<span class="sd">    Source:</span>
<span class="sd">    http://kuttler.eu/post/using-django-tables2-filters-crispy-forms-together/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set these in instantiated classes:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">table_class</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">formhelper_class</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">context_filter_name</span> <span class="o">=</span> <span class="s1">&#39;filter&#39;</span>

<div class="viewcode-block" id="PagedFilteredTableView.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.PagedFilteredTableView.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the queryset through the specified filter class.&quot;&quot;&quot;</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PagedFilteredTableView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">helper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formhelper_class</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">qs</span></div>

<div class="viewcode-block" id="PagedFilteredTableView.get_table"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.PagedFilteredTableView.get_table">[docs]</a>    <span class="k">def</span> <span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paginate the table as per paginate_by and request parameters.&quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PagedFilteredTableView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_table</span><span class="p">()</span>
        <span class="n">RequestConfig</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
            <span class="n">paginate</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;page&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s2">&quot;per_page&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">paginate_by</span><span class="p">})</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table</span></div>

<div class="viewcode-block" id="PagedFilteredTableView.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.PagedFilteredTableView.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the specified filter class to context.&quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PagedFilteredTableView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">()</span>
        <span class="n">context</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">context_filter_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span>
        <span class="k">return</span> <span class="n">context</span></div></div>


<div class="viewcode-block" id="EncounterTableView"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterTableView">[docs]</a><span class="k">class</span> <span class="nc">EncounterTableView</span><span class="p">(</span><span class="n">PagedFilteredTableView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filtered paginated TableView for Encounter.&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Encounter</span>
    <span class="n">table_class</span> <span class="o">=</span> <span class="n">EncounterTable</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">EncounterFilter</span>
    <span class="n">formhelper_class</span> <span class="o">=</span> <span class="n">EncounterListFormHelper</span></div>


<span class="c1">#-----------------------------------------------------------------------------#</span>
<span class="c1"># Encounter</span>
<div class="viewcode-block" id="EncounterList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterList">[docs]</a><span class="k">class</span> <span class="nc">EncounterList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Encounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">EncounterFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">EncounterResource</span>

<div class="viewcode-block" id="EncounterList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EncounterFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="EncounterList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;observer&quot;</span><span class="p">,</span> <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-when&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EncounterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="EncounterDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterDetail">[docs]</a><span class="k">class</span> <span class="nc">EncounterDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Encounter</span>

<div class="viewcode-block" id="EncounterDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.EncounterDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EncounterDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># data[&#39;tags&#39;] = TagObservation.objects.filter(encounter__in=[self.get_object()])</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<span class="c1">#-----------------------------------------------------------------------------#</span>
<span class="c1"># AnimalEncounter</span>
<div class="viewcode-block" id="AnimalEncounterTableView"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterTableView">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterTableView</span><span class="p">(</span><span class="n">EncounterTableView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filtered paginated TableView for AninmalEncounter.&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
    <span class="n">table_class</span> <span class="o">=</span> <span class="n">AnimalEncounterTable</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">AnimalEncounterFilter</span>
    <span class="n">formhelper_class</span> <span class="o">=</span> <span class="n">AnimalEncounterListFormHelper</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;observations/encounter.html&quot;</span></div>


<div class="viewcode-block" id="AnimalEncounterList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterList">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">AnimalEncounterFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">AnimalEncounterResource</span>

<div class="viewcode-block" id="AnimalEncounterList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AnimalEncounterFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="AnimalEncounterList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;observer&quot;</span><span class="p">,</span> <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-when&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AnimalEncounterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="AnimalEncounterCreate"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterCreate">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">AnimalEncounterForm</span>

<div class="viewcode-block" id="AnimalEncounterCreate.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterCreate.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterCreate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FlipperTagObservationFormSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FlipperTagObservationFormSet</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;formset_prefix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;encounter&#39;</span>  <span class="c1"># We set this in order to give the JavaScript something to match.</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="AnimalEncounterCreate.post"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterCreate.post">[docs]</a>    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># If the user clicked Cancel, redirect back to the list view.</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cancel&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;observations:animalencounter-list&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterCreate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnimalEncounterCreate.form_valid"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterCreate.form_valid">[docs]</a>    <span class="k">def</span> <span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">()</span>
        <span class="n">flipper_tags</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">transaction</span><span class="o">.</span><span class="n">atomic</span><span class="p">():</span>
            <span class="c1"># Set observer and reporter to the request user.</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">observer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">reporter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">flipper_tags</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
                <span class="n">flipper_tags</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span>
                <span class="n">flipper_tags</span><span class="o">.</span><span class="n">tag_type</span> <span class="o">=</span> <span class="s1">&#39;flipper-tag&#39;</span>
                <span class="n">flipper_tags</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterCreate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AnimalEncounterDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterDetail">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>

<div class="viewcode-block" id="AnimalEncounterDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TagObservation</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">encounter__in</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object</span><span class="p">()])</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<div class="viewcode-block" id="AnimalEncounterUpdate"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterUpdate">[docs]</a><span class="k">class</span> <span class="nc">AnimalEncounterUpdate</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AnimalEncounter</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">AnimalEncounterForm</span>

<div class="viewcode-block" id="AnimalEncounterUpdate.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterUpdate.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterUpdate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FlipperTagObservationFormSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FlipperTagObservationFormSet</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;formset_prefix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;encounter&#39;</span>  <span class="c1"># We set this in order to give the JavaScript something to match.</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="AnimalEncounterUpdate.post"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterUpdate.post">[docs]</a>    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># If the user clicked Cancel, redirect back to the detail view.</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cancel&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object</span><span class="p">()</span><span class="o">.</span><span class="n">get_absolute_url</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterUpdate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnimalEncounterUpdate.form_valid"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.AnimalEncounterUpdate.form_valid">[docs]</a>    <span class="k">def</span> <span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">()</span>
        <span class="n">flipper_tags</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s1">&#39;flipper_tags&#39;</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">transaction</span><span class="o">.</span><span class="n">atomic</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">flipper_tags</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
                <span class="n">flipper_tags</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span>
                <span class="n">flipper_tags</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AnimalEncounterUpdate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span></div></div>


<span class="c1"># -----------------------------------------------------------------------------#</span>
<span class="c1"># TNE</span>
<div class="viewcode-block" id="TurtleNestEncounterList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.TurtleNestEncounterList">[docs]</a><span class="k">class</span> <span class="nc">TurtleNestEncounterList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">TurtleNestEncounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">TurtleNestEncounterFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">TurtleNestEncounterResource</span>

<div class="viewcode-block" id="TurtleNestEncounterList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.TurtleNestEncounterList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TurtleNestEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TurtleNestEncounterFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="TurtleNestEncounterList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.TurtleNestEncounterList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TurtleNestEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;observer&quot;</span><span class="p">,</span> <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-when&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">TurtleNestEncounterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="TurtleNestEncounterDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.TurtleNestEncounterDetail">[docs]</a><span class="k">class</span> <span class="nc">TurtleNestEncounterDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">TurtleNestEncounter</span>

<div class="viewcode-block" id="TurtleNestEncounterDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.TurtleNestEncounterDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TurtleNestEncounterDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># data[&#39;tags&#39;] = TagObservation.objects.filter(encounter__in=[self.get_object()])</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<span class="c1"># -----------------------------------------------------------------------------#</span>
<span class="c1"># LineTransectEncounter</span>
<div class="viewcode-block" id="LineTransectEncounterList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LineTransectEncounterList">[docs]</a><span class="k">class</span> <span class="nc">LineTransectEncounterList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LineTransectEncounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">LineTransectEncounterFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">LineTransectEncounterResource</span>

<div class="viewcode-block" id="LineTransectEncounterList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LineTransectEncounterList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LineTransectEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LineTransectEncounterFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="LineTransectEncounterList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LineTransectEncounterList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LineTransectEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;observer&quot;</span><span class="p">,</span> <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-when&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">LineTransectEncounterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="LineTransectEncounterDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LineTransectEncounterDetail">[docs]</a><span class="k">class</span> <span class="nc">LineTransectEncounterDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LineTransectEncounter</span>

<div class="viewcode-block" id="LineTransectEncounterDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LineTransectEncounterDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LineTransectEncounterDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># data[&#39;tags&#39;] = TagObservation.objects.filter(encounter__in=[self.get_object()])</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<span class="c1"># -----------------------------------------------------------------------------#</span>
<span class="c1"># LoggerEncounter</span>
<div class="viewcode-block" id="LoggerEncounterList"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LoggerEncounterList">[docs]</a><span class="k">class</span> <span class="nc">LoggerEncounterList</span><span class="p">(</span><span class="n">ListViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">ResourceDownloadMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LoggerEncounter</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;pages/default_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">LoggerEncounterFilter</span>
    <span class="n">resource_class</span> <span class="o">=</span> <span class="n">LoggerEncounterResource</span>

<div class="viewcode-block" id="LoggerEncounterList.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LoggerEncounterList.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LoggerEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;list_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LoggerEncounterFilter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="LoggerEncounterList.get_queryset"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LoggerEncounterList.get_queryset">[docs]</a>    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LoggerEncounterList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span>
            <span class="s2">&quot;observer&quot;</span><span class="p">,</span> <span class="s2">&quot;reporter&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-when&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">LoggerEncounterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span><span class="o">.</span><span class="n">qs</span></div></div>


<div class="viewcode-block" id="LoggerEncounterDetail"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LoggerEncounterDetail">[docs]</a><span class="k">class</span> <span class="nc">LoggerEncounterDetail</span><span class="p">(</span><span class="n">DetailViewBreadcrumbMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LoggerEncounter</span>

<div class="viewcode-block" id="LoggerEncounterDetail.get_context_data"><a class="viewcode-back" href="../../../developers.html#wastd.observations.views.LoggerEncounterDetail.get_context_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LoggerEncounterDetail</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># data[&#39;tags&#39;] = TagObservation.objects.filter(encounter__in=[self.get_object()])</span>
        <span class="k">return</span> <span class="n">data</span></div></div>


<span class="c1"># Django-Rest-Swagger View ---------------------------------------------------#</span>
<span class="c1"># http://www.django-rest-framework.org/topics/3.5-announcement/#improved-schema-generation</span>
<span class="n">schema_view</span> <span class="o">=</span> <span class="n">get_schema_view</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;WAStD API&#39;</span><span class="p">,</span>
    <span class="n">renderer_classes</span><span class="o">=</span><span class="p">[</span><span class="n">OpenAPIRenderer</span><span class="p">,</span> <span class="n">CoreJSONRenderer</span><span class="p">,</span> <span class="n">SwaggerUIRenderer</span><span class="p">])</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020 DBCA

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>